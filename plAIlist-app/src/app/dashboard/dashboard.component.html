<div class="dashboard-container">
  
  <!-- Navbar -->
  <nav class="navbar">
    <div class="navbar-left">
      <h1 class="logo">ğŸµ PlAIlist</h1>
    </div>
    <div class="tabs">
      <button 
        [class.active]="searchType === 'artist'"
        (click)="changeSearchType('artist')">
        {{ 'dashboard.search.tabs.artists' | translate }}
      </button>
      <button 
      [class.active]="searchType === 'track'"
      (click)="changeSearchType('track')">
      {{ 'dashboard.search.tabs.tracks' | translate }}
    </button>
  </div>
  
  <!-- Barra de bÃºsqueda -->
  <div class="search-container">
    <div class="search-box">
      <input 
      type="text"
      [(ngModel)]="searchQuery"
      [placeholder]="'dashboard.search.placeholder' | translate"
      (keyup.enter)="onSearch()"
      class="search-input">
      <button 
      (click)="onSearch()" 
      class="btn-search"
      [disabled]="isSearching || !searchQuery">
      ğŸ” {{ 'dashboard.search.button' | translate }}
    </button>
    <button 
    *ngIf="searchQuery"
    (click)="clearSearch()" 
    class="btn-clear">
    âœ–
  </button>
</div>
</div>

    
    <div class="navbar-right">
      <!-- Selector de idioma -->
      <select [(ngModel)]="currentLanguage" (change)="changeLanguage(currentLanguage)">
        <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
        <option value="en">ğŸ‡ºğŸ‡¸ English</option>
      </select>
      
      <!-- Info del usuario -->
      <div class="user-info" *ngIf="currentUser">
        <span>{{ 'dashboard.welcome' | translate }}, {{ currentUser?.fullName }}</span>
        <button (click)="logout()" class="btn-logout">
          {{ 'dashboard.logout' | translate }}
        </button>

      </div>
    </div>
  </nav>
  
<!-- SecciÃ³n principal -->
  <main class="main-content">
    <!-- Sidebar izquierdo -->
    <aside class="sidebar-section">
      <app-sidebar></app-sidebar>
    </aside>
    
    <!-- Contenido principal -->
    <section class="content-section">
      <!-- Loading -->
      <div *ngIf="isSearching" class="loading">
        <div class="spinner"></div>
        <p>{{ 'dashboard.search.thinking' | translate }}</p>
      </div>

      <!-- Error -->
      <div *ngIf="errorMessage" class="error-message">
        {{ errorMessage }}
      </div>

      <!-- Resultados: Artistas -->
      <div *ngIf="searchType === 'artist' && artists.length > 0 && !isSearching" class="results">
        <div class="results-list">
          @for(artist of artists; track artist.id) {
            <div class="artist-list-item" (click)="selectArtist(artist)">
              <div class="artist-thumbnail">
                <img [src]="artist.images[0]?.url || 'assets/placeholder.png'" [alt]="artist.name">
              </div>
              <div class="artist-info">
                <h3 class="artist-name">{{ artist.name }}</h3>
                <div class="artist-meta">
                  <span class="artist-followers">{{ artist.followers?.total || 0 }} followers</span>
                  <span class="artist-popularity">Popularity: {{ artist.popularity || 0 }}</span>
                </div>
              </div>
              <div class="artist-actions">
                <a [href]="artist.external_urls.spotify" target="_blank" class="btn-spotify-small">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 14.5v-9l6 4.5-6 4.5z"/>
                  </svg>
                  Spotify
                </a>
                <button (click)="selectArtist(artist); $event.stopPropagation()" class="btn-details">
                  Details
                </button>
              </div>
            </div>
            <div *ngIf="isSearching" class="loading">
              <div class="spinner"></div>
              <p>{{ 'dashboard.search.thinking' | translate }}</p>
            </div>
            @if(selectedArtist === artist && !isSearching){
              <app-artist-panel [artistDetail]="selectedArtist"></app-artist-panel>
            }
          }

        </div>
      </div>

      <!-- Sin resultados -->
      <div *ngIf="!isSearching && searchQuery && artists.length === 0 && tracks.length === 0" class="no-results">
        <p>{{ 'dashboard.search.noResults' | translate }} "{{ searchQuery }}"</p>
      </div>
      
      <!-- Panel de artista seleccionado -->
      
    </section>
  </main>
</div>
